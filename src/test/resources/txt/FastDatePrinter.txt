/*    1:    0 */ package org.apache.commons.lang3.time;
/*    2:    0 */
/*    3:    0 */ import java.io.IOException;
/*    4:    0 */ import java.io.ObjectInputStream;
/*    5:    0 */ import java.io.Serializable;
/*    6:    0 */ import java.text.DateFormatSymbols;
/*    7:    0 */ import java.text.FieldPosition;
/*    8:    0 */ import java.util.ArrayList;
/*    9:    0 */ import java.util.Calendar;
/*   10:    0 */ import java.util.Date;
/*   11:    0 */ import java.util.List;
/*   12:    0 */ import java.util.Locale;
/*   13:    0 */ import java.util.TimeZone;
/*   14:    0 */ import java.util.concurrent.ConcurrentHashMap;
/*   15:    0 */ import java.util.concurrent.ConcurrentMap;
/*   16:    0 */ import org.apache.commons.lang3.ClassUtils;
/*   17:    0 */ import org.apache.commons.lang3.LocaleUtils;
/*   18:    0 */ import org.apache.commons.lang3.exception.ExceptionUtils;
/*   19:    0 */
/*   20:    0 */
/*   21:    0 */
/*   22:    0 */
/*   23:    0 */
/*   24:    0 */
/*   25:    0 */
/*   26:    0 */
/*   27:    0 */
/*   28:    0 */
/*   29:    0 */
/*   30:    0 */
/*   31:    0 */
/*   32:    0 */
/*   33:    0 */
/*   34:    0 */
/*   35:    0 */
/*   36:    0 */
/*   37:    0 */
/*   38:    0 */
/*   39:    0 */
/*   40:    0 */
/*   41:    0 */
/*   42:    0 */
/*   43:    0 */
/*   44:    0 */
/*   45:    0 */
/*   46:    0 */
/*   47:    0 */
/*   48:    0 */
/*   49:    0 */
/*   50:    0 */
/*   51:    0 */
/*   52:    0 */
/*   53:    0 */
/*   54:    0 */
/*   55:    0 */
/*   56:    0 */
/*   57:    0 */
/*   58:    0 */
/*   59:    0 */
/*   60:    0 */
/*   61:    0 */
/*   62:    0 */
/*   63:    0 */
/*   64:    0 */
/*   65:    0 */
/*   66:    0 */
/*   67:    0 */
/*   68:    0 */
/*   69:    0 */
/*   70:    0 */
/*   71:    0 */
/*   72:    0 */
/*   73:    0 */
/*   74:    0 */
/*   75:    0 */
/*   76:    0 */
/*   77:    0 */
/*   78:    0 */
/*   79:    0 */
/*   80:    0 */
/*   81:    0 */
/*   82:    0 */
/*   83:    0 */
/*   84:    0 */
/*   85:    0 */
/*   86:    0 */
/*   87:    0 */
/*   88:    0 */
/*   89:    0 */
/*   90:    0 */
/*   91:    0 */
/*   92:    0 */
/*   93:    0 */
/*   94:    0 */
/*   95:    0 */
/*   96:    0 */
/*   97:    0 */
/*   98:    0 */
/*   99:    0 */
/*  100:    0 */ public class FastDatePrinter
/*  101:    0 */   implements DatePrinter, Serializable
/*  102:    0 */ {
/*  103:    0 */   private static class CharacterLiteral
/*  104:    0 */     implements Rule
/*  105:    0 */   {
/*  106:    0 */     private final char value;
/*  107:    0 */
/*  108:    0 */     CharacterLiteral(char value) {
/*  109:  109 */       this.value = value;
/*  110:    0 */     }
/*  111:    0 */
/*  112:    0 */
/*  113:    0 */
/*  114:    0 */
/*  115:    0 */
/*  116:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  117:  117 */       buffer.append(this.value);
/*  118:    0 */     }
/*  119:    0 */
/*  120:    0 */
/*  121:    0 */
/*  122:    0 */
/*  123:    0 */
/*  124:    0 */     public int estimateLength() {
/*  125:  125 */       return 1;
/*  126:    0 */     }
/*  127:    0 */   }
/*  128:    0 */
/*  129:    0 */
/*  130:    0 */   private static class DayInWeekField
/*  131:    0 */     implements NumberRule
/*  132:    0 */   {
/*  133:    0 */     private final FastDatePrinter.NumberRule rule;
/*  134:    0 */
/*  135:    0 */     DayInWeekField(FastDatePrinter.NumberRule rule) {
/*  136:  136 */       this.rule = rule;
/*  137:    0 */     }
/*  138:    0 */
/*  139:    0 */
/*  140:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  141:  141 */       int value = calendar.get(7);
/*  142:  142 */       this.rule.appendTo(buffer, (value == 1) ? 7 : (value - 1));
/*  143:    0 */     }
/*  144:    0 */
/*  145:    0 */
/*  146:    0 */     public void appendTo(Appendable buffer, int value) throws IOException {
/*  147:  147 */       this.rule.appendTo(buffer, value);
/*  148:    0 */     }
/*  149:    0 */
/*  150:    0 */
/*  151:    0 */     public int estimateLength() {
/*  152:  152 */       return this.rule.estimateLength();
/*  153:    0 */     }
/*  154:    0 */   }
/*  155:    0 */
/*  156:    0 */
/*  157:    0 */
/*  158:    0 */
/*  159:    0 */
/*  160:    0 */   private static class Iso8601_Rule
/*  161:    0 */     implements Rule
/*  162:    0 */   {
/*  163:  163 */     static final Iso8601_Rule ISO8601_HOURS = new Iso8601_Rule(3);
/*  164:    0 */
/*  165:  165 */     static final Iso8601_Rule ISO8601_HOURS_MINUTES = new Iso8601_Rule(5);
/*  166:    0 */
/*  167:  167 */     static final Iso8601_Rule ISO8601_HOURS_COLON_MINUTES = new Iso8601_Rule(6);
/*  168:    0 */
/*  169:    0 */
/*  170:    0 */
/*  171:    0 */     private final int length;
/*  172:    0 */
/*  173:    0 */
/*  174:    0 */
/*  175:    0 */
/*  176:    0 */     static Iso8601_Rule getRule(int tokenLen) {
/*  177:  177 */       switch (tokenLen) {
/*  178:    0 */         case 1:
/*  179:  179 */           return ISO8601_HOURS;
/*  180:    0 */         case 2:
/*  181:  181 */           return ISO8601_HOURS_MINUTES;
/*  182:    0 */         case 3:
/*  183:  183 */           return ISO8601_HOURS_COLON_MINUTES;
/*  184:    0 */       }
/*  185:  185 */       throw new IllegalArgumentException("invalid number of X");
/*  186:    0 */     }
/*  187:    0 */
/*  188:    0 */
/*  189:    0 */
/*  190:    0 */
/*  191:    0 */
/*  192:    0 */
/*  193:    0 */
/*  194:    0 */
/*  195:    0 */
/*  196:    0 */     Iso8601_Rule(int length) {
/*  197:  197 */       this.length = length;
/*  198:    0 */     }
/*  199:    0 */
/*  200:    0 */
/*  201:    0 */
/*  202:    0 */
/*  203:    0 */
/*  204:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  205:  205 */       int offset = calendar.get(15) + calendar.get(16);
/*  206:  206 */       if (offset == 0) {
/*  207:  207 */         buffer.append("Z");
/*  208:    0 */
/*  209:    0 */         return;
/*  210:    0 */       }
/*  211:  211 */       if (offset < 0) {
/*  212:  212 */         buffer.append('-');
/*  213:  213 */         offset = -offset;
/*  214:    0 */       } else {
/*  215:  215 */         buffer.append('+');
/*  216:    0 */       }
/*  217:    0 */
/*  218:  218 */       int hours = offset / 3600000;
/*  219:  219 */       FastDatePrinter.appendDigits(buffer, hours);
/*  220:    0 */
/*  221:  221 */       if (this.length < 5) {
/*  222:    0 */         return;
/*  223:    0 */       }
/*  224:    0 */
/*  225:  225 */       if (this.length == 6) {
/*  226:  226 */         buffer.append(':');
/*  227:    0 */       }
/*  228:    0 */
/*  229:  229 */       int minutes = offset / 60000 - 60 * hours;
/*  230:  230 */       FastDatePrinter.appendDigits(buffer, minutes);
/*  231:    0 */     }
/*  232:    0 */
/*  233:    0 */
/*  234:    0 */
/*  235:    0 */
/*  236:    0 */
/*  237:    0 */     public int estimateLength() {
/*  238:  238 */       return this.length;
/*  239:    0 */     }
/*  240:    0 */   }
/*  241:    0 */
/*  242:    0 */
/*  243:    0 */
/*  244:    0 */
/*  245:    0 */
/*  246:    0 */
/*  247:    0 */
/*  248:    0 */
/*  249:    0 */   private static class PaddedNumberField
/*  250:    0 */     implements NumberRule
/*  251:    0 */   {
/*  252:    0 */     private final int field;
/*  253:    0 */
/*  254:    0 */
/*  255:    0 */
/*  256:    0 */
/*  257:    0 */
/*  258:    0 */
/*  259:    0 */     private final int size;
/*  260:    0 */
/*  261:    0 */
/*  262:    0 */
/*  263:    0 */
/*  264:    0 */
/*  265:    0 */
/*  266:    0 */
/*  267:    0 */     PaddedNumberField(int field, int size) {
/*  268:  268 */       if (size < 3)
/*  269:    0 */       {
/*  270:  270 */         throw new IllegalArgumentException();
/*  271:    0 */       }
/*  272:  272 */       this.field = field;
/*  273:  273 */       this.size = size;
/*  274:    0 */     }
/*  275:    0 */
/*  276:    0 */
/*  277:    0 */
/*  278:    0 */
/*  279:    0 */
/*  280:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  281:  281 */       appendTo(buffer, calendar.get(this.field));
/*  282:    0 */     }
/*  283:    0 */
/*  284:    0 */
/*  285:    0 */
/*  286:    0 */
/*  287:    0 */
/*  288:    0 */     public final void appendTo(Appendable buffer, int value) throws IOException {
/*  289:  289 */       FastDatePrinter.appendFullDigits(buffer, value, this.size);
/*  290:    0 */     }
/*  291:    0 */
/*  292:    0 */
/*  293:    0 */
/*  294:    0 */
/*  295:    0 */
/*  296:    0 */     public int estimateLength() {
/*  297:  297 */       return this.size;
/*  298:    0 */     }
/*  299:    0 */   }
/*  300:    0 */
/*  301:    0 */
/*  302:    0 */
/*  303:    0 */
/*  304:    0 */
/*  305:    0 */
/*  306:    0 */
/*  307:    0 */
/*  308:    0 */
/*  309:    0 */
/*  310:    0 */
/*  311:    0 */
/*  312:    0 */
/*  313:    0 */
/*  314:    0 */
/*  315:    0 */   private static class StringLiteral
/*  316:    0 */     implements Rule
/*  317:    0 */   {
/*  318:    0 */     private final String value;
/*  319:    0 */
/*  320:    0 */
/*  321:    0 */
/*  322:    0 */
/*  323:    0 */
/*  324:    0 */
/*  325:    0 */
/*  326:    0 */
/*  327:    0 */
/*  328:    0 */
/*  329:    0 */
/*  330:    0 */
/*  331:    0 */
/*  332:    0 */
/*  333:    0 */
/*  334:    0 */     StringLiteral(String value) {
/*  335:  335 */       this.value = value;
/*  336:    0 */     }
/*  337:    0 */
/*  338:    0 */
/*  339:    0 */
/*  340:    0 */
/*  341:    0 */
/*  342:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  343:  343 */       buffer.append(this.value);
/*  344:    0 */     }
/*  345:    0 */
/*  346:    0 */
/*  347:    0 */
/*  348:    0 */
/*  349:    0 */
/*  350:    0 */     public int estimateLength() {
/*  351:  351 */       return this.value.length();
/*  352:    0 */     }
/*  353:    0 */   }
/*  354:    0 */
/*  355:    0 */
/*  356:    0 */
/*  357:    0 */
/*  358:    0 */   private static class TextField
/*  359:    0 */     implements Rule
/*  360:    0 */   {
/*  361:    0 */     private final int field;
/*  362:    0 */
/*  363:    0 */
/*  364:    0 */     private final String[] values;
/*  365:    0 */
/*  366:    0 */
/*  367:    0 */
/*  368:    0 */     TextField(int field, String[] values) {
/*  369:  369 */       this.field = field;
/*  370:  370 */       this.values = values;
/*  371:    0 */     }
/*  372:    0 */
/*  373:    0 */
/*  374:    0 */
/*  375:    0 */
/*  376:    0 */
/*  377:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  378:  378 */       buffer.append(this.values[calendar.get(this.field)]);
/*  379:    0 */     }
/*  380:    0 */
/*  381:    0 */
/*  382:    0 */
/*  383:    0 */
/*  384:    0 */
/*  385:    0 */     public int estimateLength() {
/*  386:  386 */       int max = 0;
/*  387:  387 */       for (int i = this.values.length; --i >= 0; ) {
/*  388:  388 */         int len = this.values[i].length();
/*  389:  389 */         if (len > max) {
/*  390:  390 */           max = len;
/*  391:    0 */         }
/*  392:    0 */       }
/*  393:  393 */       return max;
/*  394:    0 */     }
/*  395:    0 */   }
/*  396:    0 */
/*  397:    0 */
/*  398:    0 */
/*  399:    0 */
/*  400:    0 */   private static class TimeZoneDisplayKey
/*  401:    0 */   {
/*  402:    0 */     private final TimeZone timeZone;
/*  403:    0 */
/*  404:    0 */
/*  405:    0 */
/*  406:    0 */     private final int style;
/*  407:    0 */
/*  408:    0 */
/*  409:    0 */     private final Locale locale;
/*  410:    0 */
/*  411:    0 */
/*  412:    0 */
/*  413:    0 */     TimeZoneDisplayKey(TimeZone timeZone, boolean daylight, int style, Locale locale) {
/*  414:  414 */       this.timeZone = timeZone;
/*  415:  415 */       if (daylight) {
/*  416:  416 */         this.style = style | Integer.MIN_VALUE;
/*  417:    0 */       } else {
/*  418:  418 */         this.style = style;
/*  419:    0 */       }
/*  420:  420 */       this.locale = LocaleUtils.toLocale(locale);
/*  421:    0 */     }
/*  422:    0 */
/*  423:    0 */
/*  424:    0 */
/*  425:    0 */
/*  426:    0 */
/*  427:    0 */     public boolean equals(Object obj) {
/*  428:  428 */       if (this == obj) {
/*  429:  429 */         return true;
/*  430:    0 */       }
/*  431:  431 */       if (obj instanceof TimeZoneDisplayKey) {
/*  432:  432 */         TimeZoneDisplayKey other = (TimeZoneDisplayKey)obj;
/*  433:  433 */         return (
/*  434:  434 */           this.timeZone.equals(other.timeZone) && this.style == other.style &&
/*  435:    0 */
/*  436:  436 */           this.locale.equals(other.locale));
/*  437:    0 */       }
/*  438:  438 */       return false;
/*  439:    0 */     }
/*  440:    0 */
/*  441:    0 */
/*  442:    0 */
/*  443:    0 */
/*  444:    0 */
/*  445:    0 */     public int hashCode() {
/*  446:  446 */       return (this.style * 31 + this.locale.hashCode()) * 31 + this.timeZone.hashCode();
/*  447:    0 */     }
/*  448:    0 */   }
/*  449:    0 */
/*  450:    0 */
/*  451:    0 */
/*  452:    0 */   private static class TimeZoneNameRule
/*  453:    0 */     implements Rule
/*  454:    0 */   {
/*  455:    0 */     private final Locale locale;
/*  456:    0 */
/*  457:    0 */
/*  458:    0 */     private final int style;
/*  459:    0 */
/*  460:    0 */     private final String standard;
/*  461:    0 */
/*  462:    0 */     private final String daylight;
/*  463:    0 */
/*  464:    0 */
/*  465:    0 */     TimeZoneNameRule(TimeZone timeZone, Locale locale, int style) {
/*  466:  466 */       this.locale = LocaleUtils.toLocale(locale);
/*  467:  467 */       this.style = style;
/*  468:  468 */       this.standard = FastDatePrinter.getTimeZoneDisplay(timeZone, false, style, locale);
/*  469:  469 */       this.daylight = FastDatePrinter.getTimeZoneDisplay(timeZone, true, style, locale);
/*  470:    0 */     }
/*  471:    0 */
/*  472:    0 */
/*  473:    0 */
/*  474:    0 */
/*  475:    0 */
/*  476:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  477:  477 */       TimeZone zone = calendar.getTimeZone();
/*  478:  478 */       if (calendar.get(16) == 0) {
/*  479:  479 */         buffer.append(FastDatePrinter.getTimeZoneDisplay(zone, false, this.style, this.locale));
/*  480:    0 */       } else {
/*  481:  481 */         buffer.append(FastDatePrinter.getTimeZoneDisplay(zone, true, this.style, this.locale));
/*  482:    0 */       }
/*  483:    0 */     }
/*  484:    0 */
/*  485:    0 */
/*  486:    0 */
/*  487:    0 */
/*  488:    0 */
/*  489:    0 */
/*  490:    0 */
/*  491:    0 */
/*  492:    0 */     public int estimateLength() {
/*  493:  493 */       return Math.max(this.standard.length(), this.daylight.length());
/*  494:    0 */     }
/*  495:    0 */   }
/*  496:    0 */
/*  497:    0 */
/*  498:    0 */   private static class TimeZoneNumberRule
/*  499:    0 */     implements Rule
/*  500:    0 */   {
/*  501:  501 */     static final TimeZoneNumberRule INSTANCE_COLON = new TimeZoneNumberRule(true);
/*  502:  502 */     static final TimeZoneNumberRule INSTANCE_NO_COLON = new TimeZoneNumberRule(false);
/*  503:    0 */
/*  504:    0 */
/*  505:    0 */
/*  506:    0 */     private final boolean colon;
/*  507:    0 */
/*  508:    0 */
/*  509:    0 */
/*  510:    0 */
/*  511:    0 */     TimeZoneNumberRule(boolean colon) {
/*  512:  512 */       this.colon = colon;
/*  513:    0 */     }
/*  514:    0 */
/*  515:    0 */
/*  516:    0 */
/*  517:    0 */
/*  518:    0 */
/*  519:    0 */
/*  520:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  521:  521 */       int offset = calendar.get(15) + calendar.get(16);
/*  522:    0 */
/*  523:  523 */       if (offset < 0) {
/*  524:  524 */         buffer.append('-');
/*  525:  525 */         offset = -offset;
/*  526:    0 */       } else {
/*  527:  527 */         buffer.append('+');
/*  528:    0 */       }
/*  529:    0 */
/*  530:  530 */       int hours = offset / 3600000;
/*  531:  531 */       FastDatePrinter.appendDigits(buffer, hours);
/*  532:    0 */
/*  533:  533 */       if (this.colon) {
/*  534:  534 */         buffer.append(':');
/*  535:    0 */       }
/*  536:    0 */
/*  537:  537 */       int minutes = offset / 60000 - 60 * hours;
/*  538:  538 */       FastDatePrinter.appendDigits(buffer, minutes);
/*  539:    0 */     }
/*  540:    0 */
/*  541:    0 */
/*  542:    0 */
/*  543:    0 */
/*  544:    0 */
/*  545:    0 */     public int estimateLength() {
/*  546:  546 */       return 5;
/*  547:    0 */     }
/*  548:    0 */   }
/*  549:    0 */
/*  550:    0 */
/*  551:    0 */
/*  552:    0 */
/*  553:    0 */
/*  554:    0 */   private static class TwelveHourField
/*  555:    0 */     implements NumberRule
/*  556:    0 */   {
/*  557:    0 */     private final FastDatePrinter.NumberRule rule;
/*  558:    0 */
/*  559:    0 */
/*  560:    0 */
/*  561:    0 */
/*  562:    0 */     TwelveHourField(FastDatePrinter.NumberRule rule) {
/*  563:  563 */       this.rule = rule;
/*  564:    0 */     }
/*  565:    0 */
/*  566:    0 */
/*  567:    0 */
/*  568:    0 */
/*  569:    0 */
/*  570:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  571:  571 */       int value = calendar.get(10);
/*  572:  572 */       if (value == 0) {
/*  573:  573 */         value = calendar.getLeastMaximum(10) + 1;
/*  574:    0 */       }
/*  575:  575 */       this.rule.appendTo(buffer, value);
/*  576:    0 */     }
/*  577:    0 */
/*  578:    0 */
/*  579:    0 */
/*  580:    0 */
/*  581:    0 */
/*  582:    0 */     public void appendTo(Appendable buffer, int value) throws IOException {
/*  583:  583 */       this.rule.appendTo(buffer, value);
/*  584:    0 */     }
/*  585:    0 */
/*  586:    0 */
/*  587:    0 */
/*  588:    0 */
/*  589:    0 */
/*  590:    0 */     public int estimateLength() {
/*  591:  591 */       return this.rule.estimateLength();
/*  592:    0 */     }
/*  593:    0 */   }
/*  594:    0 */
/*  595:    0 */
/*  596:    0 */
/*  597:    0 */
/*  598:    0 */
/*  599:    0 */   private static class TwentyFourHourField
/*  600:    0 */     implements NumberRule
/*  601:    0 */   {
/*  602:    0 */     private final FastDatePrinter.NumberRule rule;
/*  603:    0 */
/*  604:    0 */
/*  605:    0 */
/*  606:    0 */
/*  607:    0 */     TwentyFourHourField(FastDatePrinter.NumberRule rule) {
/*  608:  608 */       this.rule = rule;
/*  609:    0 */     }
/*  610:    0 */
/*  611:    0 */
/*  612:    0 */
/*  613:    0 */
/*  614:    0 */
/*  615:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  616:  616 */       int value = calendar.get(11);
/*  617:  617 */       if (value == 0) {
/*  618:  618 */         value = calendar.getMaximum(11) + 1;
/*  619:    0 */       }
/*  620:  620 */       this.rule.appendTo(buffer, value);
/*  621:    0 */     }
/*  622:    0 */
/*  623:    0 */
/*  624:    0 */
/*  625:    0 */
/*  626:    0 */
/*  627:    0 */     public void appendTo(Appendable buffer, int value) throws IOException {
/*  628:  628 */       this.rule.appendTo(buffer, value);
/*  629:    0 */     }
/*  630:    0 */
/*  631:    0 */
/*  632:    0 */
/*  633:    0 */
/*  634:    0 */
/*  635:    0 */     public int estimateLength() {
/*  636:  636 */       return this.rule.estimateLength();
/*  637:    0 */     }
/*  638:    0 */   }
/*  639:    0 */
/*  640:    0 */
/*  641:    0 */   private static class TwoDigitMonthField
/*  642:    0 */     implements NumberRule
/*  643:    0 */   {
/*  644:  644 */     static final TwoDigitMonthField INSTANCE = new TwoDigitMonthField();
/*  645:    0 */
/*  646:    0 */
/*  647:    0 */
/*  648:    0 */
/*  649:    0 */
/*  650:    0 */
/*  651:    0 */
/*  652:    0 */
/*  653:    0 */
/*  654:    0 */
/*  655:    0 */
/*  656:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  657:  657 */       appendTo(buffer, calendar.get(2) + 1);
/*  658:    0 */     }
/*  659:    0 */
/*  660:    0 */
/*  661:    0 */
/*  662:    0 */
/*  663:    0 */
/*  664:    0 */     public final void appendTo(Appendable buffer, int value) throws IOException {
/*  665:  665 */       FastDatePrinter.appendDigits(buffer, value);
/*  666:    0 */     }
/*  667:    0 */
/*  668:    0 */
/*  669:    0 */
/*  670:    0 */
/*  671:    0 */
/*  672:    0 */     public int estimateLength() {
/*  673:  673 */       return 2;
/*  674:    0 */     }
/*  675:    0 */   }
/*  676:    0 */
/*  677:    0 */
/*  678:    0 */
/*  679:    0 */
/*  680:    0 */   private static class TwoDigitNumberField
/*  681:    0 */     implements NumberRule
/*  682:    0 */   {
/*  683:    0 */     private final int field;
/*  684:    0 */
/*  685:    0 */
/*  686:    0 */
/*  687:    0 */
/*  688:    0 */     TwoDigitNumberField(int field) {
/*  689:  689 */       this.field = field;
/*  690:    0 */     }
/*  691:    0 */
/*  692:    0 */
/*  693:    0 */
/*  694:    0 */
/*  695:    0 */
/*  696:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  697:  697 */       appendTo(buffer, calendar.get(this.field));
/*  698:    0 */     }
/*  699:    0 */
/*  700:    0 */
/*  701:    0 */
/*  702:    0 */
/*  703:    0 */
/*  704:    0 */     public final void appendTo(Appendable buffer, int value) throws IOException {
/*  705:  705 */       if (value < 100) {
/*  706:  706 */         FastDatePrinter.appendDigits(buffer, value);
/*  707:    0 */       } else {
/*  708:  708 */         FastDatePrinter.appendFullDigits(buffer, value, 2);
/*  709:    0 */       }
/*  710:    0 */     }
/*  711:    0 */
/*  712:    0 */
/*  713:    0 */
/*  714:    0 */
/*  715:    0 */
/*  716:    0 */     public int estimateLength() {
/*  717:  717 */       return 2;
/*  718:    0 */     }
/*  719:    0 */   }
/*  720:    0 */
/*  721:    0 */
/*  722:    0 */   private static class TwoDigitYearField
/*  723:    0 */     implements NumberRule
/*  724:    0 */   {
/*  725:  725 */     static final TwoDigitYearField INSTANCE = new TwoDigitYearField();
/*  726:    0 */
/*  727:    0 */
/*  728:    0 */
/*  729:    0 */
/*  730:    0 */
/*  731:    0 */
/*  732:    0 */
/*  733:    0 */
/*  734:    0 */
/*  735:    0 */
/*  736:    0 */
/*  737:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  738:  738 */       appendTo(buffer, calendar.get(1) % 100);
/*  739:    0 */     }
/*  740:    0 */
/*  741:    0 */
/*  742:    0 */
/*  743:    0 */
/*  744:    0 */
/*  745:    0 */     public final void appendTo(Appendable buffer, int value) throws IOException {
/*  746:  746 */       FastDatePrinter.appendDigits(buffer, value % 100);
/*  747:    0 */     }
/*  748:    0 */
/*  749:    0 */
/*  750:    0 */
/*  751:    0 */
/*  752:    0 */
/*  753:    0 */     public int estimateLength() {
/*  754:  754 */       return 2;
/*  755:    0 */     }
/*  756:    0 */   }
/*  757:    0 */
/*  758:    0 */
/*  759:    0 */   private static class UnpaddedMonthField
/*  760:    0 */     implements NumberRule
/*  761:    0 */   {
/*  762:  762 */     static final UnpaddedMonthField INSTANCE = new UnpaddedMonthField();
/*  763:    0 */
/*  764:    0 */
/*  765:    0 */
/*  766:    0 */
/*  767:    0 */
/*  768:    0 */
/*  769:    0 */
/*  770:    0 */
/*  771:    0 */
/*  772:    0 */
/*  773:    0 */
/*  774:    0 */
/*  775:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  776:  776 */       appendTo(buffer, calendar.get(2) + 1);
/*  777:    0 */     }
/*  778:    0 */
/*  779:    0 */
/*  780:    0 */
/*  781:    0 */
/*  782:    0 */
/*  783:    0 */     public final void appendTo(Appendable buffer, int value) throws IOException {
/*  784:  784 */       if (value < 10) {
/*  785:  785 */         buffer.append((char)(value + 48));
/*  786:    0 */       } else {
/*  787:  787 */         FastDatePrinter.appendDigits(buffer, value);
/*  788:    0 */       }
/*  789:    0 */     }
/*  790:    0 */
/*  791:    0 */
/*  792:    0 */
/*  793:    0 */
/*  794:    0 */
/*  795:    0 */     public int estimateLength() {
/*  796:  796 */       return 2;
/*  797:    0 */     }
/*  798:    0 */   }
/*  799:    0 */
/*  800:    0 */
/*  801:    0 */
/*  802:    0 */
/*  803:    0 */   private static class UnpaddedNumberField
/*  804:    0 */     implements NumberRule
/*  805:    0 */   {
/*  806:    0 */     private final int field;
/*  807:    0 */
/*  808:    0 */
/*  809:    0 */
/*  810:    0 */
/*  811:    0 */     UnpaddedNumberField(int field) {
/*  812:  812 */       this.field = field;
/*  813:    0 */     }
/*  814:    0 */
/*  815:    0 */
/*  816:    0 */
/*  817:    0 */
/*  818:    0 */
/*  819:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  820:  820 */       appendTo(buffer, calendar.get(this.field));
/*  821:    0 */     }
/*  822:    0 */
/*  823:    0 */
/*  824:    0 */
/*  825:    0 */
/*  826:    0 */
/*  827:    0 */     public final void appendTo(Appendable buffer, int value) throws IOException {
/*  828:  828 */       if (value < 10) {
/*  829:  829 */         buffer.append((char)(value + 48));
/*  830:  830 */       } else if (value < 100) {
/*  831:  831 */         FastDatePrinter.appendDigits(buffer, value);
/*  832:    0 */       } else {
/*  833:  833 */         FastDatePrinter.appendFullDigits(buffer, value, 1);
/*  834:    0 */       }
/*  835:    0 */     }
/*  836:    0 */
/*  837:    0 */
/*  838:    0 */
/*  839:    0 */
/*  840:    0 */
/*  841:    0 */     public int estimateLength() {
/*  842:  842 */       return 4;
/*  843:    0 */     }
/*  844:    0 */   }
/*  845:    0 */
/*  846:    0 */
/*  847:    0 */   private static class WeekYear
/*  848:    0 */     implements NumberRule
/*  849:    0 */   {
/*  850:    0 */     private final FastDatePrinter.NumberRule rule;
/*  851:    0 */
/*  852:    0 */     WeekYear(FastDatePrinter.NumberRule rule) {
/*  853:  853 */       this.rule = rule;
/*  854:    0 */     }
/*  855:    0 */
/*  856:    0 */
/*  857:    0 */     public void appendTo(Appendable buffer, Calendar calendar) throws IOException {
/*  858:  858 */       this.rule.appendTo(buffer, calendar.getWeekYear());
/*  859:    0 */     }
/*  860:    0 */
/*  861:    0 */
/*  862:    0 */     public void appendTo(Appendable buffer, int value) throws IOException {
/*  863:  863 */       this.rule.appendTo(buffer, value);
/*  864:    0 */     }
/*  865:    0 */
/*  866:    0 */
/*  867:    0 */     public int estimateLength() {
/*  868:  868 */       return this.rule.estimateLength();
/*  869:    0 */     }
/*  870:    0 */   }
/*  871:    0 */
/*  872:    0 */
/*  873:  873 */   private static final Rule[] EMPTY_RULE_ARRAY = new Rule[0];
/*  874:    0 */
/*  875:    0 */
/*  876:    0 */
/*  877:    0 */
/*  878:    0 */   private static final long serialVersionUID = 1L;
/*  879:    0 */
/*  880:    0 */
/*  881:    0 */
/*  882:    0 */
/*  883:    0 */   public static final int FULL = 0;
/*  884:    0 */
/*  885:    0 */
/*  886:    0 */
/*  887:    0 */
/*  888:    0 */   public static final int LONG = 1;
/*  889:    0 */
/*  890:    0 */
/*  891:    0 */
/*  892:    0 */   public static final int MEDIUM = 2;
/*  893:    0 */
/*  894:    0 */
/*  895:    0 */
/*  896:    0 */   public static final int SHORT = 3;
/*  897:    0 */
/*  898:    0 */
/*  899:    0 */
/*  900:    0 */   private static final int MAX_DIGITS = 10;
/*  901:    0 */
/*  902:    0 */
/*  903:    0 */
/*  904:  904 */   private static final ConcurrentMap<TimeZoneDisplayKey, String> cTimeZoneDisplayCache = new ConcurrentHashMap<>(7);
/*  905:    0 */
/*  906:    0 */   private final String pattern;
/*  907:    0 */
/*  908:    0 */   private final TimeZone timeZone;
/*  909:    0 */
/*  910:    0 */   private final Locale locale;
/*  911:    0 */   private transient Rule[] rules;
/*  912:    0 */   private transient int maxLengthEstimate;
/*  913:    0 */
/*  914:    0 */   private static void appendDigits(Appendable buffer, int value) throws IOException {
/*  915:  915 */     buffer.append((char)(value / 10 + 48));
/*  916:  916 */     buffer.append((char)(value % 10 + 48));
/*  917:    0 */   }
/*  918:    0 */
/*  919:    0 */
/*  920:    0 */
/*  921:    0 */
/*  922:    0 */
/*  923:    0 */
/*  924:    0 */
/*  925:    0 */
/*  926:    0 */
/*  927:    0 */
/*  928:    0 */
/*  929:    0 */   private static void appendFullDigits(Appendable buffer, int value, int minFieldWidth) throws IOException {
/*  930:  930 */     if (value < 10000) {
/*  931:    0 */
/*  932:    0 */
/*  933:  933 */       int nDigits = 4;
/*  934:  934 */       if (value < 1000) {
/*  935:  935 */         nDigits--;
/*  936:  936 */         if (value < 100) {
/*  937:  937 */           nDigits--;
/*  938:  938 */           if (value < 10) {
/*  939:  939 */             nDigits--;
/*  940:    0 */           }
/*  941:    0 */         }
/*  942:    0 */       }
/*  943:    0 */
/*  944:  944 */       for (int i = minFieldWidth - nDigits; i > 0; i--) {
/*  945:  945 */         buffer.append('0');
/*  946:    0 */       }
/*  947:    0 */
/*  948:  948 */       switch (nDigits) {
/*  949:    0 */         case 4:
/*  950:  950 */           buffer.append((char)(value / 1000 + 48));
/*  951:  951 */           value %= 1000;
/*  952:    0 */         case 3:
/*  953:  953 */           if (value >= 100) {
/*  954:  954 */             buffer.append((char)(value / 100 + 48));
/*  955:  955 */             value %= 100;
/*  956:    0 */           } else {
/*  957:  957 */             buffer.append('0');
/*  958:    0 */           }
/*  959:    0 */         case 2:
/*  960:  960 */           if (value >= 10) {
/*  961:  961 */             buffer.append((char)(value / 10 + 48));
/*  962:  962 */             value %= 10;
/*  963:    0 */           } else {
/*  964:  964 */             buffer.append('0');
/*  965:    0 */           }
/*  966:    0 */         case 1:
/*  967:  967 */           buffer.append((char)(value + 48));
/*  968:    0 */           break;
/*  969:    0 */       }
/*  970:    0 */
/*  971:    0 */
/*  972:    0 */     } else {
/*  973:  973 */       char[] work = new char[10];
/*  974:  974 */       int digit = 0;
/*  975:  975 */       while (value != 0) {
/*  976:  976 */         work[digit++] = (char)(value % 10 + 48);
/*  977:  977 */         value /= 10;
/*  978:    0 */       }
/*  979:    0 */
/*  980:    0 */
/*  981:  981 */       while (digit < minFieldWidth) {
/*  982:  982 */         buffer.append('0');
/*  983:  983 */         minFieldWidth--;
/*  984:    0 */       }
/*  985:    0 */
/*  986:    0 */
/*  987:  987 */       while (--digit >= 0) {
/*  988:  988 */         buffer.append(work[digit]);
/*  989:    0 */       }
/*  990:    0 */     }
/*  991:    0 */   }
/*  992:    0 */
/*  993:    0 */
/*  994:    0 */
/*  995:    0 */
/*  996:    0 */
/*  997:    0 */
/*  998:    0 */
/*  999:    0 */
/* 1000:    0 */
/* 1001:    0 */
/* 1002:    0 */   static String getTimeZoneDisplay(TimeZone tz, boolean daylight, int style, Locale locale) {
/* 1003: 1003 */     TimeZoneDisplayKey key = new TimeZoneDisplayKey(tz, daylight, style, locale);
/* 1004:    0 */
/* 1005: 1005 */     return cTimeZoneDisplayCache.computeIfAbsent(key, k -> tz.getDisplayName(daylight, style, locale));
/* 1006:    0 */   }
/* 1007:    0 */
/* 1008:    0 */
/* 1009:    0 */
/* 1010:    0 */
/* 1011:    0 */
/* 1012:    0 */
/* 1013:    0 */
/* 1014:    0 */
/* 1015:    0 */
/* 1016:    0 */
/* 1017:    0 */
/* 1018:    0 */
/* 1019:    0 */
/* 1020:    0 */
/* 1021:    0 */
/* 1022:    0 */
/* 1023:    0 */
/* 1024:    0 */
/* 1025:    0 */
/* 1026:    0 */
/* 1027:    0 */
/* 1028:    0 */
/* 1029:    0 */
/* 1030:    0 */
/* 1031:    0 */
/* 1032:    0 */
/* 1033:    0 */
/* 1034:    0 */
/* 1035:    0 */
/* 1036:    0 */
/* 1037:    0 */
/* 1038:    0 */
/* 1039:    0 */
/* 1040:    0 */
/* 1041:    0 */
/* 1042:    0 */
/* 1043:    0 */
/* 1044:    0 */   protected FastDatePrinter(String pattern, TimeZone timeZone, Locale locale) {
/* 1045: 1045 */     this.pattern = pattern;
/* 1046: 1046 */     this.timeZone = timeZone;
/* 1047: 1047 */     this.locale = LocaleUtils.toLocale(locale);
/* 1048: 1048 */     init();
/* 1049:    0 */   }
/* 1050:    0 */
/* 1051:    0 */
/* 1052:    0 */
/* 1053:    0 */
/* 1054:    0 */
/* 1055:    0 */
/* 1056:    0 */
/* 1057:    0 */
/* 1058:    0 */
/* 1059:    0 */
/* 1060:    0 */   private <B extends Appendable> B applyRules(Calendar calendar, B buf) {
/* 1061:    0 */     try {
/* 1062: 1062 */       for (Rule rule : this.rules) {
/* 1063: 1063 */         rule.appendTo(buf, calendar);
/* 1064:    0 */       }
/* 1065: 1065 */     } catch (IOException ioe) {
/* 1066: 1066 */       ExceptionUtils.asRuntimeException(ioe);
/* 1067:    0 */     }
/* 1068: 1068 */     return buf;
/* 1069:    0 */   }
/* 1070:    0 */
/* 1071:    0 */
/* 1072:    0 */
/* 1073:    0 */
/* 1074:    0 */
/* 1075:    0 */
/* 1076:    0 */
/* 1077:    0 */
/* 1078:    0 */
/* 1079:    0 */
/* 1080:    0 */
/* 1081:    0 */   @Deprecated
/* 1082:    0 */   protected StringBuffer applyRules(Calendar calendar, StringBuffer buf) {
/* 1083: 1083 */     return (StringBuffer)applyRules(calendar, (Appendable)buf);
/* 1084:    0 */   }
/* 1085:    0 */
/* 1086:    0 */
/* 1087:    0 */
/* 1088:    0 */
/* 1089:    0 */
/* 1090:    0 */
/* 1091:    0 */   private String applyRulesToString(Calendar c) {
/* 1092: 1092 */     return applyRules(c, new StringBuilder(this.maxLengthEstimate)).toString();
/* 1093:    0 */   }
/* 1094:    0 */
/* 1095:    0 */
/* 1096:    0 */
/* 1097:    0 */
/* 1098:    0 */
/* 1099:    0 */
/* 1100:    0 */
/* 1101:    0 */
/* 1102:    0 */
/* 1103:    0 */   public boolean equals(Object obj) {
/* 1104: 1104 */     if (!(obj instanceof FastDatePrinter)) {
/* 1105: 1105 */       return false;
/* 1106:    0 */     }
/* 1107: 1107 */     FastDatePrinter other = (FastDatePrinter)obj;
/* 1108: 1108 */     return (this.pattern.equals(other.pattern) &&
/* 1109: 1109 */       this.timeZone.equals(other.timeZone) &&
/* 1110: 1110 */       this.locale.equals(other.locale));
/* 1111:    0 */   }
/* 1112:    0 */
/* 1113:    0 */
/* 1114:    0 */
/* 1115:    0 */
/* 1116:    0 */
/* 1117:    0 */   public String format(Calendar calendar) {
/* 1118: 1118 */     return format(calendar, new StringBuilder(this.maxLengthEstimate)).toString();
/* 1119:    0 */   }
/* 1120:    0 */
/* 1121:    0 */
/* 1122:    0 */
/* 1123:    0 */
/* 1124:    0 */
/* 1125:    0 */
/* 1126:    0 */   public <B extends Appendable> B format(Calendar calendar, B buf) {
/* 1127: 1127 */     if (!calendar.getTimeZone().equals(this.timeZone)) {
/* 1128: 1128 */       calendar = (Calendar)calendar.clone();
/* 1129: 1129 */       calendar.setTimeZone(this.timeZone);
/* 1130:    0 */     }
/* 1131: 1131 */     return applyRules(calendar, buf);
/* 1132:    0 */   }
/* 1133:    0 */
/* 1134:    0 */
/* 1135:    0 */
/* 1136:    0 */
/* 1137:    0 */
/* 1138:    0 */
/* 1139:    0 */   public StringBuffer format(Calendar calendar, StringBuffer buf) {
/* 1140: 1140 */     return format(calendar.getTime(), buf);
/* 1141:    0 */   }
/* 1142:    0 */
/* 1143:    0 */
/* 1144:    0 */
/* 1145:    0 */
/* 1146:    0 */
/* 1147:    0 */   public String format(Date date) {
/* 1148: 1148 */     Calendar c = newCalendar();
/* 1149: 1149 */     c.setTime(date);
/* 1150: 1150 */     return applyRulesToString(c);
/* 1151:    0 */   }
/* 1152:    0 */
/* 1153:    0 */
/* 1154:    0 */
/* 1155:    0 */
/* 1156:    0 */
/* 1157:    0 */   public <B extends Appendable> B format(Date date, B buf) {
/* 1158: 1158 */     Calendar c = newCalendar();
/* 1159: 1159 */     c.setTime(date);
/* 1160: 1160 */     return applyRules(c, buf);
/* 1161:    0 */   }
/* 1162:    0 */
/* 1163:    0 */
/* 1164:    0 */
/* 1165:    0 */
/* 1166:    0 */
/* 1167:    0 */   public StringBuffer format(Date date, StringBuffer buf) {
/* 1168: 1168 */     Calendar c = newCalendar();
/* 1169: 1169 */     c.setTime(date);
/* 1170: 1170 */     return (StringBuffer)applyRules(c, (Appendable)buf);
/* 1171:    0 */   }
/* 1172:    0 */
/* 1173:    0 */
/* 1174:    0 */
/* 1175:    0 */
/* 1176:    0 */
/* 1177:    0 */   public String format(long millis) {
/* 1178: 1178 */     Calendar c = newCalendar();
/* 1179: 1179 */     c.setTimeInMillis(millis);
/* 1180: 1180 */     return applyRulesToString(c);
/* 1181:    0 */   }
/* 1182:    0 */
/* 1183:    0 */
/* 1184:    0 */
/* 1185:    0 */
/* 1186:    0 */
/* 1187:    0 */   public <B extends Appendable> B format(long millis, B buf) {
/* 1188: 1188 */     Calendar c = newCalendar();
/* 1189: 1189 */     c.setTimeInMillis(millis);
/* 1190: 1190 */     return applyRules(c, buf);
/* 1191:    0 */   }
/* 1192:    0 */
/* 1193:    0 */
/* 1194:    0 */
/* 1195:    0 */
/* 1196:    0 */
/* 1197:    0 */   public StringBuffer format(long millis, StringBuffer buf) {
/* 1198: 1198 */     Calendar c = newCalendar();
/* 1199: 1199 */     c.setTimeInMillis(millis);
/* 1200: 1200 */     return (StringBuffer)applyRules(c, (Appendable)buf);
/* 1201:    0 */   }
/* 1202:    0 */
/* 1203:    0 */
/* 1204:    0 */
/* 1205:    0 */
/* 1206:    0 */
/* 1207:    0 */
/* 1208:    0 */
/* 1209:    0 */
/* 1210:    0 */   String format(Object obj) {
/* 1211: 1211 */     if (obj instanceof Date) {
/* 1212: 1212 */       return format((Date)obj);
/* 1213:    0 */     }
/* 1214: 1214 */     if (obj instanceof Calendar) {
/* 1215: 1215 */       return format((Calendar)obj);
/* 1216:    0 */     }
/* 1217: 1217 */     if (obj instanceof Long) {
/* 1218: 1218 */       return format(((Long)obj).longValue());
/* 1219:    0 */     }
/* 1220: 1220 */     throw new IllegalArgumentException("Unknown class: " + ClassUtils.getName(obj, "<null>"));
/* 1221:    0 */   }
/* 1222:    0 */
/* 1223:    0 */
/* 1224:    0 */
/* 1225:    0 */
/* 1226:    0 */
/* 1227:    0 */
/* 1228:    0 */
/* 1229:    0 */
/* 1230:    0 */
/* 1231:    0 */
/* 1232:    0 */
/* 1233:    0 */
/* 1234:    0 */   @Deprecated
/* 1235:    0 */   public StringBuffer format(Object obj, StringBuffer toAppendTo, FieldPosition pos) {
/* 1236: 1236 */     if (obj instanceof Date) {
/* 1237: 1237 */       return format((Date)obj, toAppendTo);
/* 1238:    0 */     }
/* 1239: 1239 */     if (obj instanceof Calendar) {
/* 1240: 1240 */       return format((Calendar)obj, toAppendTo);
/* 1241:    0 */     }
/* 1242: 1242 */     if (obj instanceof Long) {
/* 1243: 1243 */       return format(((Long)obj).longValue(), toAppendTo);
/* 1244:    0 */     }
/* 1245: 1245 */     throw new IllegalArgumentException("Unknown class: " + ClassUtils.getName(obj, "<null>"));
/* 1246:    0 */   }
/* 1247:    0 */
/* 1248:    0 */
/* 1249:    0 */
/* 1250:    0 */
/* 1251:    0 */
/* 1252:    0 */   public Locale getLocale() {
/* 1253: 1253 */     return this.locale;
/* 1254:    0 */   }
/* 1255:    0 */
/* 1256:    0 */
/* 1257:    0 */
/* 1258:    0 */
/* 1259:    0 */
/* 1260:    0 */
/* 1261:    0 */
/* 1262:    0 */
/* 1263:    0 */
/* 1264:    0 */
/* 1265:    0 */   public int getMaxLengthEstimate() {
/* 1266: 1266 */     return this.maxLengthEstimate;
/* 1267:    0 */   }
/* 1268:    0 */
/* 1269:    0 */
/* 1270:    0 */
/* 1271:    0 */
/* 1272:    0 */
/* 1273:    0 */
/* 1274:    0 */   public String getPattern() {
/* 1275: 1275 */     return this.pattern;
/* 1276:    0 */   }
/* 1277:    0 */
/* 1278:    0 */
/* 1279:    0 */
/* 1280:    0 */
/* 1281:    0 */
/* 1282:    0 */   public TimeZone getTimeZone() {
/* 1283: 1283 */     return this.timeZone;
/* 1284:    0 */   }
/* 1285:    0 */
/* 1286:    0 */
/* 1287:    0 */
/* 1288:    0 */
/* 1289:    0 */
/* 1290:    0 */
/* 1291:    0 */
/* 1292:    0 */   public int hashCode() {
/* 1293: 1293 */     return this.pattern.hashCode() + 13 * (this.timeZone.hashCode() + 13 * this.locale.hashCode());
/* 1294:    0 */   }
/* 1295:    0 */
/* 1296:    0 */
/* 1297:    0 */
/* 1298:    0 */
/* 1299:    0 */   private void init() {
/* 1300: 1300 */     List<Rule> rulesList = parsePattern();
/* 1301: 1301 */     this.rules = rulesList.<Rule>toArray(EMPTY_RULE_ARRAY);
/* 1302:    0 */
/* 1303: 1303 */     int len = 0;
/* 1304: 1304 */     for (int i = this.rules.length; --i >= 0;) {
/* 1305: 1305 */       len += this.rules[i].estimateLength();
/* 1306:    0 */     }
/* 1307:    0 */
/* 1308: 1308 */     this.maxLengthEstimate = len;
/* 1309:    0 */   }
/* 1310:    0 */
/* 1311:    0 */
/* 1312:    0 */
/* 1313:    0 */
/* 1314:    0 */
/* 1315:    0 */
/* 1316:    0 */   private Calendar newCalendar() {
/* 1317: 1317 */     return Calendar.getInstance(this.timeZone, this.locale);
/* 1318:    0 */   }
/* 1319:    0 */
/* 1320:    0 */
/* 1321:    0 */
/* 1322:    0 */
/* 1323:    0 */
/* 1324:    0 */
/* 1325:    0 */
/* 1326:    0 */
/* 1327:    0 */   protected List<Rule> parsePattern() {
/* 1328: 1328 */     DateFormatSymbols symbols = new DateFormatSymbols(this.locale);
/* 1329: 1329 */     List<Rule> rules = new ArrayList<>();
/* 1330:    0 */
/* 1331: 1331 */     String[] ERAs = symbols.getEras();
/* 1332: 1332 */     String[] months = symbols.getMonths();
/* 1333: 1333 */     String[] shortMonths = symbols.getShortMonths();
/* 1334: 1334 */     String[] weekdays = symbols.getWeekdays();
/* 1335: 1335 */     String[] shortWeekdays = symbols.getShortWeekdays();
/* 1336: 1336 */     String[] AmPmStrings = symbols.getAmPmStrings();
/* 1337:    0 */
/* 1338: 1338 */     int length = this.pattern.length();
/* 1339: 1339 */     int[] indexRef = new int[1];
/* 1340:    0 */
/* 1341: 1341 */     for (int i = 0; i < length; i++) {
/* 1342: 1342 */       Rule rule; String sub; indexRef[0] = i;
/* 1343: 1343 */       String token = parseToken(this.pattern, indexRef);
/* 1344: 1344 */       i = indexRef[0];
/* 1345:    0 */
/* 1346: 1346 */       int tokenLen = token.length();
/* 1347: 1347 */       if (tokenLen == 0) {
/* 1348:    0 */         break;
/* 1349:    0 */       }
/* 1350:    0 */
/* 1351:    0 */
/* 1352: 1352 */       char c = token.charAt(0);
/* 1353:    0 */
/* 1354: 1354 */       switch (c) {
/* 1355:    0 */         case 'G':
/* 1356: 1356 */           rule = new TextField(0, ERAs);
/* 1357:    0 */           break;
/* 1358:    0 */         case 'Y':
/* 1359:    0 */         case 'y':
/* 1360: 1360 */           if (tokenLen == 2) {
/* 1361: 1361 */             rule = TwoDigitYearField.INSTANCE;
/* 1362:    0 */           } else {
/* 1363: 1363 */             rule = selectNumberRule(1, Math.max(tokenLen, 4));
/* 1364:    0 */           }
/* 1365: 1365 */           if (c == 'Y') {
/* 1366: 1366 */             rule = new WeekYear((NumberRule)rule);
/* 1367:    0 */           }
/* 1368:    0 */           break;
/* 1369:    0 */         case 'M':
/* 1370: 1370 */           if (tokenLen >= 4) {
/* 1371: 1371 */             rule = new TextField(2, months);
/* 1372: 1372 */           } else if (tokenLen == 3) {
/* 1373: 1373 */             rule = new TextField(2, shortMonths);
/* 1374: 1374 */           } else if (tokenLen == 2) {
/* 1375: 1375 */             rule = TwoDigitMonthField.INSTANCE;
/* 1376:    0 */           } else {
/* 1377: 1377 */             rule = UnpaddedMonthField.INSTANCE;
/* 1378:    0 */           }
/* 1379:    0 */           break;
/* 1380:    0 */         case 'L':
/* 1381: 1381 */           if (tokenLen >= 4) {
/* 1382: 1382 */             rule = new TextField(2, CalendarUtils.getInstance(this.locale).getStandaloneLongMonthNames());
/* 1383: 1383 */           } else if (tokenLen == 3) {
/* 1384: 1384 */             rule = new TextField(2, CalendarUtils.getInstance(this.locale).getStandaloneShortMonthNames());
/* 1385: 1385 */           } else if (tokenLen == 2) {
/* 1386: 1386 */             rule = TwoDigitMonthField.INSTANCE;
/* 1387:    0 */           } else {
/* 1388: 1388 */             rule = UnpaddedMonthField.INSTANCE;
/* 1389:    0 */           }
/* 1390:    0 */           break;
/* 1391:    0 */         case 'd':
/* 1392: 1392 */           rule = selectNumberRule(5, tokenLen);
/* 1393:    0 */           break;
/* 1394:    0 */         case 'h':
/* 1395: 1395 */           rule = new TwelveHourField(selectNumberRule(10, tokenLen));
/* 1396:    0 */           break;
/* 1397:    0 */         case 'H':
/* 1398: 1398 */           rule = selectNumberRule(11, tokenLen);
/* 1399:    0 */           break;
/* 1400:    0 */         case 'm':
/* 1401: 1401 */           rule = selectNumberRule(12, tokenLen);
/* 1402:    0 */           break;
/* 1403:    0 */         case 's':
/* 1404: 1404 */           rule = selectNumberRule(13, tokenLen);
/* 1405:    0 */           break;
/* 1406:    0 */         case 'S':
/* 1407: 1407 */           rule = selectNumberRule(14, tokenLen);
/* 1408:    0 */           break;
/* 1409:    0 */         case 'E':
/* 1410: 1410 */           rule = new TextField(7, (tokenLen < 4) ? shortWeekdays : weekdays);
/* 1411:    0 */           break;
/* 1412:    0 */         case 'u':
/* 1413: 1413 */           rule = new DayInWeekField(selectNumberRule(7, tokenLen));
/* 1414:    0 */           break;
/* 1415:    0 */         case 'D':
/* 1416: 1416 */           rule = selectNumberRule(6, tokenLen);
/* 1417:    0 */           break;
/* 1418:    0 */         case 'F':
/* 1419: 1419 */           rule = selectNumberRule(8, tokenLen);
/* 1420:    0 */           break;
/* 1421:    0 */         case 'w':
/* 1422: 1422 */           rule = selectNumberRule(3, tokenLen);
/* 1423:    0 */           break;
/* 1424:    0 */         case 'W':
/* 1425: 1425 */           rule = selectNumberRule(4, tokenLen);
/* 1426:    0 */           break;
/* 1427:    0 */         case 'a':
/* 1428: 1428 */           rule = new TextField(9, AmPmStrings);
/* 1429:    0 */           break;
/* 1430:    0 */         case 'k':
/* 1431: 1431 */           rule = new TwentyFourHourField(selectNumberRule(11, tokenLen));
/* 1432:    0 */           break;
/* 1433:    0 */         case 'K':
/* 1434: 1434 */           rule = selectNumberRule(10, tokenLen);
/* 1435:    0 */           break;
/* 1436:    0 */         case 'X':
/* 1437: 1437 */           rule = Iso8601_Rule.getRule(tokenLen);
/* 1438:    0 */           break;
/* 1439:    0 */         case 'z':
/* 1440: 1440 */           if (tokenLen >= 4) {
/* 1441: 1441 */             rule = new TimeZoneNameRule(this.timeZone, this.locale, 1);
/* 1442:    0 */           } else {
/* 1443: 1443 */             rule = new TimeZoneNameRule(this.timeZone, this.locale, 0);
/* 1444:    0 */           }
/* 1445:    0 */           break;
/* 1446:    0 */         case 'Z':
/* 1447: 1447 */           if (tokenLen == 1) {
/* 1448: 1448 */             rule = TimeZoneNumberRule.INSTANCE_NO_COLON;
/* 1449: 1449 */           } else if (tokenLen == 2) {
/* 1450: 1450 */             rule = Iso8601_Rule.ISO8601_HOURS_COLON_MINUTES;
/* 1451:    0 */           } else {
/* 1452: 1452 */             rule = TimeZoneNumberRule.INSTANCE_COLON;
/* 1453:    0 */           }
/* 1454:    0 */           break;
/* 1455:    0 */         case '\'':
/* 1456: 1456 */           sub = token.substring(1);
/* 1457: 1457 */           if (sub.length() == 1) {
/* 1458: 1458 */             rule = new CharacterLiteral(sub.charAt(0));
/* 1459:    0 */           } else {
/* 1460: 1460 */             rule = new StringLiteral(sub);
/* 1461:    0 */           }
/* 1462:    0 */           break;
/* 1463:    0 */         default:
/* 1464: 1464 */           throw new IllegalArgumentException("Illegal pattern component: " + token);
/* 1465:    0 */       }
/* 1466:    0 */
/* 1467: 1467 */       rules.add(rule);
/* 1468:    0 */     }
/* 1469:    0 */
/* 1470: 1470 */     return rules;
/* 1471:    0 */   }
/* 1472:    0 */
/* 1473:    0 */
/* 1474:    0 */
/* 1475:    0 */
/* 1476:    0 */
/* 1477:    0 */
/* 1478:    0 */
/* 1479:    0 */
/* 1480:    0 */   protected String parseToken(String pattern, int[] indexRef) {
/* 1481: 1481 */     StringBuilder buf = new StringBuilder();
/* 1482:    0 */
/* 1483: 1483 */     int i = indexRef[0];
/* 1484: 1484 */     int length = pattern.length();
/* 1485:    0 */
/* 1486: 1486 */     char c = pattern.charAt(i);
/* 1487: 1487 */     if ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z')) {
/* 1488:    0 */
/* 1489:    0 */
/* 1490: 1490 */       buf.append(c);
/* 1491:    0 */
/* 1492: 1492 */       while (i + 1 < length) {
/* 1493: 1493 */         char peek = pattern.charAt(i + 1);
/* 1494: 1494 */         if (peek != c) {
/* 1495:    0 */           break;
/* 1496:    0 */         }
/* 1497: 1497 */         buf.append(c);
/* 1498: 1498 */         i++;
/* 1499:    0 */       }
/* 1500:    0 */     } else {
/* 1501:    0 */
/* 1502: 1502 */       buf.append('\'');
/* 1503:    0 */
/* 1504: 1504 */       boolean inLiteral = false;
/* 1505:    0 */
/* 1506: 1506 */       for (; i < length; i++) {
/* 1507: 1507 */         c = pattern.charAt(i);
/* 1508:    0 */
/* 1509: 1509 */         if (c == '\'')
/* 1510: 1510 */         { if (i + 1 < length && pattern.charAt(i + 1) == '\'') {
/* 1511:    0 */
/* 1512: 1512 */             i++;
/* 1513: 1513 */             buf.append(c);
/* 1514:    0 */           } else {
/* 1515: 1515 */             inLiteral = !inLiteral;
/* 1516:    0 */           }  }
/* 1517: 1517 */         else { if (!inLiteral && ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'))) {
/* 1518:    0 */
/* 1519: 1519 */             i--;
/* 1520:    0 */             break;
/* 1521:    0 */           }
/* 1522: 1522 */           buf.append(c); }
/* 1523:    0 */
/* 1524:    0 */       }
/* 1525:    0 */     }
/* 1526:    0 */
/* 1527: 1527 */     indexRef[0] = i;
/* 1528: 1528 */     return buf.toString();
/* 1529:    0 */   }
/* 1530:    0 */
/* 1531:    0 */
/* 1532:    0 */
/* 1533:    0 */
/* 1534:    0 */
/* 1535:    0 */
/* 1536:    0 */
/* 1537:    0 */
/* 1538:    0 */
/* 1539:    0 */
/* 1540:    0 */   private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {
/* 1541: 1541 */     in.defaultReadObject();
/* 1542: 1542 */     init();
/* 1543:    0 */   }
/* 1544:    0 */
/* 1545:    0 */
/* 1546:    0 */
/* 1547:    0 */
/* 1548:    0 */
/* 1549:    0 */
/* 1550:    0 */
/* 1551:    0 */
/* 1552:    0 */   protected NumberRule selectNumberRule(int field, int padding) {
/* 1553: 1553 */     switch (padding) {
/* 1554:    0 */       case 1:
/* 1555: 1555 */         return new UnpaddedNumberField(field);
/* 1556:    0 */       case 2:
/* 1557: 1557 */         return new TwoDigitNumberField(field);
/* 1558:    0 */     }
/* 1559: 1559 */     return new PaddedNumberField(field, padding);
/* 1560:    0 */   }
/* 1561:    0 */
/* 1562:    0 */
/* 1563:    0 */
/* 1564:    0 */
/* 1565:    0 */
/* 1566:    0 */
/* 1567:    0 */
/* 1568:    0 */
/* 1569:    0 */   public String toString() {
/* 1570: 1570 */     return "FastDatePrinter[" + this.pattern + "," + this.locale + "," + this.timeZone.getID() + "]";
/* 1571:    0 */   }
/* 1572:    0 */
/* 1573:    0 */   private static interface Rule {
/* 1574:    0 */     void appendTo(Appendable param1Appendable, Calendar param1Calendar) throws IOException;
/* 1575:    0 */
/* 1576:    0 */     int estimateLength();
/* 1577:    0 */   }
/* 1578:    0 */
/* 1579:    0 */   private static interface NumberRule extends Rule {
/* 1580:    0 */     void appendTo(Appendable param1Appendable, int param1Int) throws IOException;
/* 1581:    0 */   }
/* 1582:    0 */ }
